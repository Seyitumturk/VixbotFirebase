<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.16/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="/products.css">

</head>


<body>
    <div class="wrapper">

        <div id="bigSidebar"
            class="flex flex-col items-center w-64 h-full overflow-hidden text-gray-400 bg-gray-900 rounded ">
            <a class="flex items-center w-full px-3 mt-3" href="#">
                <svg class="w-14 h-14 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                    fill="currentColor">
                    <path
                        d="M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V9.236a1 1 0 00-1.447-.894l-4 2a1 1 0 00-.553.894V17zM15.211 6.276a1 1 0 000-1.788l-4.764-2.382a1 1 0 00-.894 0L4.789 4.488a1 1 0 000 1.788l4.764 2.382a1 1 0 00.894 0l4.764-2.382zM4.447 8.342A1 1 0 003 9.236V15a1 1 0 00.553.894l4 2A1 1 0 009 17v-5.764a1 1 0 00-.553-.894l-4-2z" />
                </svg>
                <span class="ml-2 text-sm font-bold">VixBot</span>
            </a>
            <a class="flex items-center w-full h-12 px-3 mt-2 rounded hover:bg-gray-700 hover:text-gray-300 mt-20"
                href="/conversations">
                <!-- ... -->
                <span class="ml-2 text-sm font-medium">Ideate</span>
            </a>
            <!-- ... -->
            <!-- Products link -->
            <a class="flex items-center w-full h-12 px-3 mt-2 rounded hover:bg-gray-700 hover:text-gray-300"
                href="/products">
                <!-- ... -->
                <span class="ml-2 text-sm font-medium">Products</span>
            </a>
            <!-- Templates link -->
            <a class="flex items-center w-full h-12 px-3 mt-2 rounded hover:bg-gray-700 hover:text-gray-300"
                href="/templates">
                <!-- Add an appropriate SVG icon for Templates -->
                <span class="ml-2 text-sm font-medium">Templates</span>
            </a>



        </div>
        <div class="main-content">

            <!-- Page content -->
            <div class="container-fluid mt--7">
                <!-- Table -->
                <div class="row">
                    <div class="col">
                        <div class="card shadow">
                            <div class="card-header bg-transparent">
                                <h3 class="mb-0">Products</h3>
                                <button id="add-product-btn" class="btn btn-primary">+</button>
                            </div>
                            <div id="card-body-extend" class="card-body">
                                <div class="row icon-examples">
                                    <!-- Add Product button -->




                                    <!-- Product creation form (hidden by default) -->

                                    <!-- Create a new modal for creating a new product -->
                                    <div class="modal fade" id="create-product-modal" tabindex="-1" role="dialog"
                                        aria-labelledby="create-product-modal-label" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="create-product-modal-label">
                                                        Create a New Product</h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <!-- Add a single question at a time -->
                                                    <form id="create-product-form" method="POST"
                                                        action="/create-product">
                                                        <div class="form-group" id="product-name-group">
                                                            <label for="product-name">Product Name:</label>
                                                            <input type="text" id="product-name" name="product_name"
                                                                class="form-control" required>
                                                        </div>
                                                        <div class="form-group" id="main-features-group">
                                                            <label for="main-features">Main Features:</label>
                                                            <textarea id="main-features" name="main_features"
                                                                class="form-control" required></textarea>
                                                        </div>
                                                        <div class="form-group" id="unique-selling-points-group">
                                                            <label for="unique-selling-points">Unique Selling
                                                                Points:</label>
                                                            <textarea id="unique-selling-points"
                                                                name="unique_selling_points" class="form-control"
                                                                required></textarea>
                                                        </div>
                                                        <div class="form-group" id="pricing-model-group">
                                                            <label for="pricing-model">Pricing Model:</label>
                                                            <select id="pricing-model" name="pricing_model"
                                                                class="form-control" required>
                                                                <option value="">Choose a pricing model</option>
                                                                <option value="pay-per-use">Pay-per-use</option>
                                                                <option value="subscription">Subscription
                                                                </option>
                                                                <option value="one-time-fee">One-time fee
                                                                </option>
                                                            </select>
                                                        </div>
                                                        <div class="form-group" id="distribution-channels-group">
                                                            <label for="distribution-channels">Distribution
                                                                Channels:</label>
                                                            <input type="text" id="distribution-channels"
                                                                name="distribution_channels" class="form-control"
                                                                required>
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary"
                                                        data-dismiss="modal">Cancel</button>
                                                    <button type="button" class="btn btn-primary"
                                                        id="next-btn">Next</button>
                                                    <button type="button" class="btn btn-primary"
                                                        id="submit-btn">Submit</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Footer -->

            </div>
        </div>

    </div>

    <script>

        $(document).ready(function () {
            // Handle the "Add Product" button click event
            $("#add-product-btn").on("click", function () {
                $("#create-product-modal").modal("show");
            });

            // Handle the form submission
            $("#submit-btn").on("click", async function (event) {
                event.preventDefault();

                const formData = {
                    product_name: $("#product-name").val(),
                    main_features: $("#main-features").val(),
                    unique_selling_points: $("#unique-selling-points").val(),
                    pricing_model: $("#pricing-model").val(),
                    distribution_channels: $("#distribution-channels").val(),
                };

                try {
                    const response = await $.ajax({
                        type: "POST",
                        url: "/create-product",
                        data: formData,
                        dataType: "html",
                    });

                    // Append the returned HTML to the card body
                    $("#card-body-extend").append(response);

                    // Close the modal and clear the form
                    $("#create-product-modal").modal("hide");
                    $("#create-product-form")[0].reset();
                } catch (error) {
                    console.error("Server response:", error.responseText);
                    alert("Failedd to create a new product. Please try again.");
                }
            });
        });
    </script>

</body>